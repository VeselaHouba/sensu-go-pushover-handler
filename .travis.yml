language: go
go:
- 1.12.x
install:
- curl -sfL https://install.goreleaser.com/github.com/golangci/golangci-lint.sh |
  sh -s -- -b $(go env GOPATH)/bin v1.17.1
script:
- golangci-lint run --disable-all --enable=vet --enable=ineffassign --enable=goconst
  --tests ./...
- go test -v -race ./...
before_script:
- echo "REPO $TRAVIS_REPO_SLUG TAG ${TRAVIS_TAG}"
deploy:
- provider: script
  script: curl -sL https://git.io/goreleaser | bash
  skip_cleanup: true
  on:
    tags: true
    condition: "$TRAVIS_OS_NAME = linux"
after_deploy:
- git clone https://github.com/sensu/sensu-go-bonsai-asset.git bonsai
- bonsai/generate-sha512sum.sh
- bonsai/github-release-upload.sh github_api_token=$GITHUB_TOKEN repo_slug="$TRAVIS_REPO_SLUG"
  tag="${TRAVIS_TAG}" filename="dist/$(cat dist/sha512_file)"
env:
  global:
  - GO111MODULE=on
  - secure: aGjpfv+8JrMdkLsiM6HdaG4fqHPqWya2XXobmKIaBSg37TrxoSp/Dlrq3VYt1/ewCXGpmlk6bgsReWi6OaOWpzdl4a7OM2LwSUPM4b5zuzauPd3XCqoD4xqnaw2Mbs4NKLkPrjK1zAElI89+F8tesiEvBUBvDBE1PUyJDmFTDByFNC23YYBxi+e4qh1BOU73PzBOjZo/7Lld7PDi3kBS68rQcQPcDz1btSqTWjxzW5O3tmQy2PjiV+lwZN2cmYCdrGVMSAWY0R1kUG3pZ8Y6GxJDMQgPqBSVv95crN1YTSMg+2/sFvkyriduo8eH+ko9AC1ykHSDyqeX6cA9Jl0xacXar+jK8nHddCAJF6dn7q+FyD/ldqrFFJLDWX6dkZQmAhLkmnpC8qT9fnoYmi2UPVxGw3eg2gCWyNMjewHj+oegF2WlOdoSNQX4E5mmUZRSSaa5fbsbPopDyIxMy5k/9u1V+TgNHaqpRSqhaSEyon43SDtu9MTIBFvCQ2q+/tWawYnFsCE8AOAVZn7XnnD5hZNubI+nisPaf2h7LqGgLRKUs8o1EKhfhgOerpcIaX3ctDjcx0dhHQslP1LubWeXzoZztoI//STlXF7ECF6fAYVBvOHjpJo9lFjUoANINOKH/CWwCvGjWa8EuXG6yxCCaFZjrfszEined6LxXcGT+x0=
